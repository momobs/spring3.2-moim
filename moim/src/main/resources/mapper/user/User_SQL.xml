<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="user">
	<select id="selectUser" parameterType="moim.user.vo.UserVO" resultType="moim.user.vo.UserVO">
		<![CDATA[
			SELECT
				USER_ID,
				USER_PWD,
				USER_NAME,
				EMAIL,
				PHONE,
				ADDRESS,
				INTRO
			FROM
				USER
			WHERE
				USER_ID = #{user_id}
		]]>
	</select>
	
	<select id="selectUserPwd" parameterType="moim.user.vo.UserVO" resultType="java.lang.String">
		<![CDATA[
			SELECT
				USER_PWD
			FROM 
				USER
			WHERE
				USER_ID = #{user_id}
		]]>
	</select>
	
	<insert id="insertUser" parameterType="moim.user.vo.UserVO" >
		<![CDATA[
			INSERT INTO USER
			(
				USER_ID,
				USER_PWD,
				USER_NAME,
				EMAIL,
				PHONE,
				ADDRESS,
				CREATE_DATE
			)
			VALUES
			(
				#{user_id},
				#{user_pwd},
				#{user_name},
				#{email},
				#{phone},
				#{address},
				now()
			)
		]]>
	</insert>
	
	<insert id="insertUserFile" parameterType="hashmap" useGeneratedKeys="true" keyProperty="idx">
		<![CDATA[
			INSERT INTO FILE_MANAGER
			(
				STORED_FILE_NAME,
				ORIGINAL_FILE_NAME,
				FILE_SIZE,
				CREATE_DATE,
				CREATE_USER,
				DEL_YN
			)
			VALUES
			(
				#{stored_file_name},
				#{original_file_name},
				#{file_size},
				now(),
				#{user_id},
				'N'
			)
		]]>
	</insert>
	
	<update id="updateUser" parameterType="hashmap">
		<![CDATA[
			UPDATE USER
			SET USER_NAME = #{user_name},
				EMAIL = #{email},
				PHONE = #{phone},
				ADDRESS = #{address}
			WHERE USER_ID = #{user_id}
		]]>
	</update>
	
	<update id="updateUserPwd" parameterType="hashmap">
		<![CDATA[
			UPDATE USER
			SET USER_PWD = #{new_password}
			WHERE USER_ID = #{user_id}
		]]>
	</update>
	
	<update id="updateUserFile" parameterType="hashmap">
		<![CDATA[
			UPDATE USER
			SET USER_PHOTO = #{idx}
			WHERE USER_ID = #{user_id}
		]]>
	</update>
</mapper>